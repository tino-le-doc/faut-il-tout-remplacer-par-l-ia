<!DOCTYPE html>
<html lang="fr">
<head>
    <!--
      Copyright (c) 2025 TLD - Tous droits reserves
      Toute copie, reproduction ou reutilisation non autorisee est interdite.
      Licence proprietaire - voir fichier LICENSE
    -->
    <meta charset="UTF-8">
    <meta http-equiv="content-language" content="fr">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8612974241235499"
         crossorigin="anonymous"></script>
    <meta name="author" content="TLD">
    <meta name="copyright" content="Copyright 2025 TLD. Tous droits reserves.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0a0a0f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="img/1000074494.png">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="img/1000074494.png">
    <meta name="description" content="Veille technologique IA : suivez les dernieres actualites, tendances et innovations en intelligence artificielle avec TLD.">
    <meta property="og:title" content="Veille Techno IA - TLD">
    <meta property="og:description" content="Suivez les dernieres actualites et tendances en intelligence artificielle. Veille technologique par TLD.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tino-le-doc.com/veille-techno.html">
    <meta property="og:locale" content="fr_FR">
    <meta property="og:image" content="https://tino-le-doc.com/img/1000074494.png">
    <title>Veille Techno IA üì° TLD</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&family=Syne:wght@700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/common.css">
    <style>
        :root {
            --bg: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --cyan: #00f5ff;
            --magenta: #ff00aa;
            --orange: #ff9500;
            --yellow: #f5ff00;
            --green: #00ff88;
            --red: #ff4444;
            --purple: #aa00ff;
            --text: #e8e8e8;
            --text-secondary: #a0a0a0;
            --glass: rgba(255,255,255,0.05);
            --glass-border: rgba(255,255,255,0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            min-height: 100dvh;
        }

        .bg-grid {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-image:
                linear-gradient(rgba(0, 245, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 245, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        .floating-orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            pointer-events: none;
            z-index: 0;
        }

        .orb-1 {
            width: 300px; height: 300px;
            background: rgba(255, 0, 170, 0.08);
            top: 10%; left: -5%;
            animation: floatOrb 20s ease-in-out infinite;
        }

        .orb-2 {
            width: 250px; height: 250px;
            background: rgba(0, 245, 255, 0.08);
            bottom: 10%; right: -5%;
            animation: floatOrb 25s ease-in-out infinite reverse;
        }

        @keyframes floatOrb {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(30px, -30px); }
            50% { transform: translate(-20px, 20px); }
            75% { transform: translate(20px, 30px); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 900px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            max-width: 180px;
            margin-bottom: 15px;
            filter: drop-shadow(0 5px 20px rgba(255, 165, 0, 0.4));
        }

        .header h1 {
            font-family: 'Syne', sans-serif;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            background: linear-gradient(135deg, var(--cyan), var(--magenta));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.05rem;
        }

        /* Stats */
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            padding: 12px 20px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            min-width: 100px;
        }

        .stat-value {
            font-family: 'Syne', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--cyan);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* Category Filter */
        .category-filter {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .filter-btn {
            padding: 8px 18px;
            border: 1px solid var(--glass-border);
            background: var(--glass);
            color: var(--text);
            border-radius: 25px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .filter-btn:hover {
            border-color: var(--cyan);
            background: rgba(0, 245, 255, 0.1);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, var(--cyan), var(--magenta));
            border-color: transparent;
            color: #fff;
            font-weight: 700;
        }

        /* Search */
        .search-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .search-bar input {
            flex: 1;
            padding: 12px 20px;
            background: var(--bg-tertiary);
            border: 2px solid var(--glass-border);
            border-radius: 25px;
            color: var(--text);
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--cyan);
        }

        .search-bar input::placeholder {
            color: var(--text-secondary);
        }

        /* Article Cards */
        .articles-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 40px;
        }

        .article-card {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s;
            animation: fadeInUp 0.5s ease-out both;
        }

        .article-card:hover {
            border-color: var(--cyan);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 245, 255, 0.1);
        }

        .article-card:nth-child(1) { animation-delay: 0s; }
        .article-card:nth-child(2) { animation-delay: 0.1s; }
        .article-card:nth-child(3) { animation-delay: 0.2s; }
        .article-card:nth-child(4) { animation-delay: 0.3s; }
        .article-card:nth-child(5) { animation-delay: 0.4s; }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .article-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
        }

        .article-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .badge-ia { background: rgba(0, 245, 255, 0.15); color: var(--cyan); }
        .badge-robotique { background: rgba(255, 0, 170, 0.15); color: var(--magenta); }
        .badge-startup { background: rgba(255, 149, 0, 0.15); color: var(--orange); }
        .badge-ethique { background: rgba(170, 0, 255, 0.15); color: var(--purple); }
        .badge-web { background: rgba(0, 255, 136, 0.15); color: var(--green); }
        .badge-hardware { background: rgba(245, 255, 0, 0.15); color: var(--yellow); }

        .article-date {
            font-size: 0.8rem;
            color: var(--text-secondary);
            white-space: nowrap;
            flex-shrink: 0;
            margin-top: 3px;
        }

        .article-title {
            font-family: 'Syne', sans-serif;
            font-size: 1.25rem;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .article-summary {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .article-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .article-tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .tag {
            padding: 3px 10px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .article-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 14px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            color: var(--text);
            font-family: inherit;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .action-btn:hover {
            border-color: var(--cyan);
            background: rgba(0, 245, 255, 0.1);
        }

        .action-btn.liked {
            border-color: var(--magenta);
            color: var(--magenta);
            background: rgba(255, 0, 170, 0.1);
        }

        /* Source indicator */
        .article-source {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .source-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--green);
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state .icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        /* Load more */
        .load-more {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
        }

        .load-more-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, var(--cyan), var(--magenta));
            border: none;
            border-radius: 25px;
            color: #fff;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .load-more-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0, 245, 255, 0.3);
        }

        /* Submit section */
        .submit-section {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            margin-bottom: 40px;
        }

        .submit-section h2 {
            font-family: 'Syne', sans-serif;
            font-size: 1.4rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--orange), var(--yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .submit-section p {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .submit-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 500px;
            margin: 0 auto;
        }

        .submit-form input,
        .submit-form textarea,
        .submit-form select {
            padding: 12px 18px;
            background: var(--bg-tertiary);
            border: 2px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text);
            font-family: inherit;
            font-size: 0.95rem;
            transition: border-color 0.3s;
        }

        .submit-form input:focus,
        .submit-form textarea:focus,
        .submit-form select:focus {
            outline: none;
            border-color: var(--cyan);
        }

        .submit-form textarea {
            resize: vertical;
            min-height: 80px;
        }

        .submit-form select {
            cursor: pointer;
        }

        .submit-form select option {
            background: var(--bg-secondary);
            color: var(--text);
        }

        .submit-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, var(--orange), var(--yellow));
            border: none;
            border-radius: 25px;
            color: #0a0a0f;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255, 149, 0, 0.3);
        }

        /* Trending sidebar */
        .trending-section {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .trending-section h3 {
            font-family: 'Syne', sans-serif;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .trending-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 0;
            border-bottom: 1px solid var(--glass-border);
        }

        .trending-item:last-child {
            border-bottom: none;
        }

        .trending-rank {
            font-family: 'Syne', sans-serif;
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--magenta);
            min-width: 28px;
        }

        .trending-text {
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .trending-meta {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 40px 0;
            color: rgba(255,255,255,0.4);
            font-size: 0.9rem;
        }

        footer a {
            color: var(--cyan);
            text-decoration: none;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--cyan), var(--magenta));
            color: #fff;
            border-radius: 25px;
            font-family: inherit;
            font-size: 0.95rem;
            font-weight: 700;
            z-index: 9999;
            animation: toastIn 0.3s ease-out, toastOut 0.3s ease-in 2.7s forwards;
            pointer-events: none;
        }

        @keyframes toastIn {
            from { opacity: 0; transform: translateX(-50%) translateY(20px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        @keyframes toastOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container { padding: 20px 12px; }
            .article-card { padding: 18px; }
            .article-header { flex-direction: column; gap: 8px; }
            .article-title { font-size: 1.1rem; }
            .stats-bar { gap: 12px; }
            .stat-item { min-width: 80px; padding: 10px 14px; }
            .submit-section { padding: 20px; }
            .trending-section { padding: 18px; }
        }
    </style>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "TLD",
      "url": "https://tino-le-doc.com",
      "logo": "https://tino-le-doc.com/img/1000074494.png"
    }
    </script>
</head>
<body>
    <a href="appareils-connectes.html" class="tino-iot-banner" aria-label="Tino Assistant IoT">
        <span class="tino-iot-banner-icon">üì°</span>
        <span class="tino-iot-banner-text">
            <span class="tino-iot-banner-title">Tino Assistant IoT</span>
            <span class="tino-iot-banner-sub">Appareils connectes &amp; IA</span>
        </span>
        <span class="tino-iot-banner-dot"></span>
    </a>
    <a href="#main-content" class="skip-link">Aller au contenu</a>
    <nav class="nav-dropdown" aria-label="Navigation rapide">
        <select onchange="if(this.value) window.location.href=this.value" aria-label="Naviguer vers une page">
            <option value="">&#9776; Menu</option>
            <option value="index.html">&#127968; Accueil</option>
            <option value="veille-techno.html" selected>&#128225; Veille Techno</option>
            <option value="quiz.html">&#129504; Quiz</option>
            <option value="sondages.html">&#128202; Sondages</option>
            <option value="debat.html">&#9876;&#65039; D&eacute;bat</option>
            <option value="tchat.html">&#128172; Tchat</option>
            <option value="messagerie.html">&#9993;&#65039; Messagerie</option>
            <option value="forum.html">&#127963;&#65039; Forum</option>
            <option value="avis.html">&#11088; Avis</option>
            <option value="compte.html">&#128100; Compte</option>
            <option value="premium.html">&#128081; Premium</option>
            <option value="boutique.html">&#128722; Boutique</option>
            <option value="appareils-connectes.html">&#128225; Appareils IA</option>
            <option value="contact.html">&#128231; Contact</option>
            <option value="confidentialite.html">&#128274; Confidentialit&eacute;</option>
        </select>
    </nav>
    <div class="bg-grid"></div>
    <div class="floating-orb orb-1"></div>
    <div class="floating-orb orb-2"></div>

    <div class="container" id="main-content">
        <header class="header">
            <a href="index.html">
                <img src="img/1000074494.png" alt="TLD" class="logo">
            </a>
            <a href="index.html" class="back-link">&larr; Retour &agrave; l'accueil</a>
            <h1>üì° Veille Technologique IA</h1>
            <p class="subtitle">Les dernieres actus, tendances et innovations en intelligence artificielle</p>
        </header>

        <!-- Stats -->
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="totalArticles">0</div>
                <div class="stat-label">Articles</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="totalLikes">0</div>
                <div class="stat-label">Likes</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="todayCount">0</div>
                <div class="stat-label">Aujourd'hui</div>
            </div>
        </div>

        <!-- Search -->
        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="üîç Rechercher un article, un sujet..." autocomplete="off">
        </div>

        <!-- Category Filter -->
        <div class="category-filter">
            <button class="filter-btn active" data-category="all">üåê Tous</button>
            <button class="filter-btn" data-category="ia">ü§ñ IA</button>
            <button class="filter-btn" data-category="robotique">ü¶æ Robotique</button>
            <button class="filter-btn" data-category="startup">üöÄ Startups</button>
            <button class="filter-btn" data-category="ethique">‚öñÔ∏è Ethique</button>
            <button class="filter-btn" data-category="web">üåê Web</button>
            <button class="filter-btn" data-category="hardware">üîß Hardware</button>
        </div>

        <!-- Trending -->
        <div class="trending-section" id="trendingSection">
            <h3>üî• Tendances du moment</h3>
            <div id="trendingList">
                <!-- Filled by JS -->
            </div>
        </div>

        <!-- Articles -->
        <div class="articles-grid" id="articlesContainer">
            <!-- Filled by JS -->
        </div>

        <div class="load-more" id="loadMoreContainer" style="display:none;">
            <button class="load-more-btn" id="loadMoreBtn">Charger plus d'articles</button>
        </div>

        <!-- Submit an article (Admin only) -->
        <div class="submit-section" id="adminSection" style="display:none;">
            <h2>üìù Publier un article (Admin)</h2>
            <p>Ajoute un nouvel article a la veille technologique.</p>
            <form class="submit-form" id="submitForm">
                <input type="text" id="submitTitle" placeholder="Titre de l'article" maxlength="150" required>
                <input type="url" id="submitUrl" placeholder="Lien (URL) de la source" required>
                <textarea id="submitSummary" placeholder="Resume en quelques lignes..." maxlength="500" required></textarea>
                <select id="submitCategory" required>
                    <option value="">-- Categorie --</option>
                    <option value="ia">ü§ñ Intelligence Artificielle</option>
                    <option value="robotique">ü¶æ Robotique</option>
                    <option value="startup">üöÄ Startups</option>
                    <option value="ethique">‚öñÔ∏è Ethique</option>
                    <option value="web">üåê Web / Dev</option>
                    <option value="hardware">üîß Hardware</option>
                </select>
                <button type="submit" class="submit-btn">üöÄ Soumettre</button>
            </form>
        </div>

        <footer role="contentinfo">
            <p><strong>TLD</strong> - Veille Techno IA</p>
            <nav aria-label="Navigation principale">
            <div class="footer-links">
                <a href="index.html">üè† Accueil</a>
                <a href="quiz.html">üß† Quiz</a>
                <a href="sondages.html">üìä Sondages</a>
                <a href="debat.html">‚öîÔ∏è Debat</a>
                <a href="tchat.html">üí¨ Tchat</a>
                <a href="messagerie.html">‚úâÔ∏è Messagerie</a>
                <a href="forum.html">üèõÔ∏è Forum</a>
                <a href="avis.html">‚≠ê Avis</a>
                <a href="compte.html">üë§ Compte</a>
                <a href="premium.html">üëë Premium</a>
                <a href="boutique.html">üõí Boutique</a>
                <a href="appareils-connectes.html">üì° Appareils IA</a>
                <a href="contact.html">üìß Contact</a>
                <a href="confidentialite.html">üîí Confidentialite</a>
            </div>
            </nav>
        </footer>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    <script>
        const db = firebase.database();
        const auth = firebase.auth();

        const ARTICLES_PATH = 'veilleArticles';
        const TRENDING_PATH = 'veilleTrending';
        let currentCategory = 'all';
        let searchQuery = '';
        let allArticles = [];
        let displayCount = 10;
        let currentUser = null;
        let articlesSeeded = false; // Evite les doublons

        // ==================== 15 ARTICLES PRE-REMPLIS ====================
        const now = Date.now();
        const DAY = 86400000;

        const SEED_ARTICLES = [
            {
                id: 'seed-1',
                title: "Claude 4 d'Anthropic : le modele le plus puissant jamais cree",
                url: "https://www.anthropic.com",
                summary: "Anthropic devoile Claude 4, son nouveau modele d'IA capable de raisonnement avance, de codage complexe et d'analyse multi-documents. Des performances qui surpassent GPT-4o sur la majorite des benchmarks.",
                category: "ia",
                tags: ["Claude", "Anthropic", "LLM", "IA"],
                source: "anthropic.com",
                timestamp: now,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 42
            },
            {
                id: 'seed-2',
                title: "OpenAI lance GPT-5 : vers l'AGI ?",
                url: "https://openai.com",
                summary: "OpenAI presente GPT-5, un modele multimodal natif qui comprend texte, images, audio et video. Sam Altman affirme que c'est un pas majeur vers l'intelligence artificielle generale (AGI).",
                category: "ia",
                tags: ["GPT", "OpenAI", "AGI", "LLM"],
                source: "openai.com",
                timestamp: now - DAY,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 38
            },
            {
                id: 'seed-3',
                title: "Google DeepMind : Gemini 2.5 revolutionne la recherche scientifique",
                url: "https://deepmind.google",
                summary: "Gemini 2.5 de Google DeepMind est capable de concevoir des experiences scientifiques, analyser des resultats et proposer de nouvelles hypotheses. Deja utilise dans la recherche pharmaceutique.",
                category: "ia",
                tags: ["Gemini", "Google", "IA"],
                source: "deepmind.google",
                timestamp: now - DAY * 2,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 29
            },
            {
                id: 'seed-4',
                title: "Tesla Optimus Gen 3 : le robot humanoide entre en usine",
                url: "https://www.tesla.com",
                summary: "Tesla deploie la 3e generation de son robot humanoide Optimus dans ses usines. Il peut desormais manipuler des objets fragiles, marcher sur terrain irregulier et travailler 20h sans recharge.",
                category: "robotique",
                tags: ["robot", "Tesla", "IA"],
                source: "tesla.com",
                timestamp: now - DAY * 3,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 25
            },
            {
                id: 'seed-5',
                title: "L'Union Europeenne adopte l'AI Act : ce qui change",
                url: "https://digital-strategy.ec.europa.eu",
                summary: "L'AI Act europeen entre en vigueur. Les systemes d'IA a haut risque devront etre certifies, les deepfakes etiquetes, et les modeles fondateurs soumis a des obligations de transparence.",
                category: "ethique",
                tags: ["regulation", "ethique", "IA"],
                source: "ec.europa.eu",
                timestamp: now - DAY * 4,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 21
            },
            {
                id: 'seed-6',
                title: "Mistral AI leve 1 milliard et lance Mistral Large 3",
                url: "https://mistral.ai",
                summary: "La startup francaise Mistral AI boucle une levee record de 1 milliard d'euros et lance Mistral Large 3, un modele open-weight rival de GPT-4o. La France s'impose dans la course a l'IA.",
                category: "startup",
                tags: ["startup", "LLM", "open source", "IA"],
                source: "mistral.ai",
                timestamp: now - DAY * 5,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 33
            },
            {
                id: 'seed-7',
                title: "NVIDIA Blackwell Ultra : la puce qui alimente l'IA mondiale",
                url: "https://www.nvidia.com",
                summary: "NVIDIA devoile le GPU Blackwell Ultra avec 208 milliards de transistors. Capable d'entrainer des modeles de 10 000 milliards de parametres, il equipe deja les datacenters de Google, Meta et Microsoft.",
                category: "hardware",
                tags: ["NVIDIA", "GPU", "IA"],
                source: "nvidia.com",
                timestamp: now - DAY * 6,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 19
            },
            {
                id: 'seed-8',
                title: "Meta Llama 4 : l'IA open source rattrape les modeles proprietaires",
                url: "https://ai.meta.com",
                summary: "Meta publie Llama 4 en open source. Avec 400 milliards de parametres et des performances proches de GPT-5, c'est le modele libre le plus puissant. Disponible gratuitement pour la recherche et les entreprises.",
                category: "ia",
                tags: ["Meta", "LLM", "open source", "IA"],
                source: "ai.meta.com",
                timestamp: now - DAY * 7,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 27
            },
            {
                id: 'seed-9',
                title: "Cursor et les IDE IA : comment le code s'ecrit tout seul",
                url: "https://cursor.sh",
                summary: "Les IDE assistes par IA comme Cursor, GitHub Copilot Workspace et Windsurf transforment le developpement. Les developpeurs rapportent un gain de productivite de 40 a 60% sur les taches repetitives.",
                category: "web",
                tags: ["IA", "API", "startup"],
                source: "cursor.sh",
                timestamp: now - DAY * 8,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 31
            },
            {
                id: 'seed-10',
                title: "Apple Intelligence 2.0 : Siri devient vraiment intelligent",
                url: "https://www.apple.com",
                summary: "Apple deploie Intelligence 2.0 sur iPhone, iPad et Mac. Siri comprend le contexte, genere des images, resume les emails et peut executer des actions complexes entre applications.",
                category: "ia",
                tags: ["Apple", "IA"],
                source: "apple.com",
                timestamp: now - DAY * 9,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 16
            },
            {
                id: 'seed-11',
                title: "Les deepfakes IA : une menace pour la democratie ?",
                url: "https://www.lemonde.fr",
                summary: "Des videos deepfake de dirigeants politiques generees par IA circulent massivement sur les reseaux sociaux. Les experts alertent sur le risque de manipulation des elections et demandent une legislation urgente.",
                category: "ethique",
                tags: ["ethique", "IA", "video"],
                source: "lemonde.fr",
                timestamp: now - DAY * 10,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 14
            },
            {
                id: 'seed-12',
                title: "Figure 02 : le robot humanoide qui apprend en regardant des videos",
                url: "https://www.figure.ai",
                summary: "La startup Figure devoile son robot humanoide Figure 02, entraine grace a des millions d'heures de video YouTube. Il peut preparer un cafe, ranger une chambre et tenir une conversation naturelle.",
                category: "robotique",
                tags: ["robot", "startup", "IA", "video"],
                source: "figure.ai",
                timestamp: now - DAY * 11,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 22
            },
            {
                id: 'seed-13',
                title: "Microsoft Copilot+ PC : l'ordinateur qui anticipe vos besoins",
                url: "https://www.microsoft.com",
                summary: "Microsoft lance ses PC Copilot+ equipes de puces NPU dediees a l'IA. Recall memorise tout, Copilot redige vos documents et les apps s'adaptent automatiquement a vos habitudes.",
                category: "hardware",
                tags: ["Microsoft", "IA"],
                source: "microsoft.com",
                timestamp: now - DAY * 12,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 11
            },
            {
                id: 'seed-14',
                title: "L'IA remplace-t-elle vraiment des emplois ? Les chiffres 2025",
                url: "https://www.mckinsey.com",
                summary: "Une etude McKinsey revele que l'IA a automatise 15% des taches dans les entreprises adoptantes, mais a cree 12% de nouveaux postes. Le bilan net reste modere, mais certains secteurs sont plus touches.",
                category: "ethique",
                tags: ["IA", "ethique"],
                source: "mckinsey.com",
                timestamp: now - DAY * 13,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 18
            },
            {
                id: 'seed-15',
                title: "Hugging Face depasse GitHub en nombre de modeles IA partages",
                url: "https://huggingface.co",
                summary: "Hugging Face franchit le cap du million de modeles heberges. La plateforme open source est devenue le hub incontournable pour partager des modeles d'IA, datasets et applications de machine learning.",
                category: "web",
                tags: ["open source", "machine learning", "IA"],
                source: "huggingface.co",
                timestamp: now - DAY * 14,
                authorName: "TLD",
                authorUid: "admin",
                likesCount: 24
            }
        ];

        const BADGE_MAP = {
            ia: { cls: 'badge-ia', label: 'ü§ñ IA' },
            robotique: { cls: 'badge-robotique', label: 'ü¶æ Robotique' },
            startup: { cls: 'badge-startup', label: 'üöÄ Startup' },
            ethique: { cls: 'badge-ethique', label: '‚öñÔ∏è Ethique' },
            web: { cls: 'badge-web', label: 'üåê Web' },
            hardware: { cls: 'badge-hardware', label: 'üîß Hardware' }
        };

        // ==================== AUTH ====================
        let isAdminUser = false;

        auth.onAuthStateChanged(user => {
            currentUser = user;
            isAdminUser = isAdmin(user);
            // Afficher/cacher la section admin
            document.getElementById('adminSection').style.display = isAdminUser ? 'block' : 'none';
            // Re-render pour afficher les boutons admin
            if (allArticles.length > 0) renderArticles();
        });

        // ==================== PERSISTANCE LIKES (localStorage) ====================
        const LIKES_STORAGE_KEY = 'veilleLikes';

        function saveLikesToStorage() {
            const data = {};
            allArticles.forEach(a => {
                if (a.likesCount > 0 || (a.likes && Object.keys(a.likes).length > 0)) {
                    data[a.id] = { likesCount: a.likesCount || 0, likes: a.likes || {} };
                }
            });
            try { localStorage.setItem(LIKES_STORAGE_KEY, JSON.stringify(data)); } catch(e) {}
        }

        function loadLikesFromStorage(articles) {
            try {
                const raw = localStorage.getItem(LIKES_STORAGE_KEY);
                if (!raw) return;
                const data = JSON.parse(raw);
                articles.forEach(a => {
                    if (data[a.id]) {
                        a.likesCount = data[a.id].likesCount;
                        a.likes = data[a.id].likes || {};
                    }
                });
            } catch(e) {}
        }

        // ==================== ARTICLES ====================
        // Afficher les articles locaux immediatement (avant Firebase)
        allArticles = SEED_ARTICLES.slice();
        // Charger aussi les articles sauvegardes localement (soumis quand Firebase etait indisponible)
        const localSaved = JSON.parse(localStorage.getItem('localVeilleArticles') || '[]');
        if (localSaved.length > 0) {
            allArticles = localSaved.concat(allArticles);
        }
        loadLikesFromStorage(allArticles);
        updateStats();
        renderArticles();

        function loadArticles() {
            db.ref(ARTICLES_PATH).orderByChild('timestamp').on('value', snap => {
                const firebaseArticles = [];
                snap.forEach(child => {
                    firebaseArticles.push({ id: child.key, ...child.val() });
                });
                // Utiliser les articles Firebase s'il y en a, sinon garder les locaux
                if (firebaseArticles.length > 0) {
                    allArticles = firebaseArticles;
                    // Sauvegarder les likes Firebase dans le storage local
                    saveLikesToStorage();
                } else {
                    allArticles = SEED_ARTICLES.slice();
                    loadLikesFromStorage(allArticles);
                }
                allArticles.reverse();
                updateStats();
                renderArticles();
            }, err => {
                console.warn('Firebase indisponible, articles locaux affiches:', err.message);
                // Garder les articles locaux deja affiches
            });
        }

        function updateStats() {
            document.getElementById('totalArticles').textContent = allArticles.length;

            let totalLikes = 0;
            let todayCount = 0;
            const todayStart = new Date();
            todayStart.setHours(0, 0, 0, 0);

            allArticles.forEach(a => {
                totalLikes += a.likesCount || 0;
                if (a.timestamp >= todayStart.getTime()) todayCount++;
            });

            document.getElementById('totalLikes').textContent = totalLikes;
            document.getElementById('todayCount').textContent = todayCount;
        }

        function filterArticles() {
            return allArticles.filter(a => {
                const matchCat = currentCategory === 'all' || a.category === currentCategory;
                const q = searchQuery.toLowerCase();
                const matchSearch = !q ||
                    (a.title || '').toLowerCase().includes(q) ||
                    (a.summary || '').toLowerCase().includes(q) ||
                    (a.tags || []).some(t => t.toLowerCase().includes(q));
                return matchCat && matchSearch;
            });
        }

        function renderArticles() {
            const container = document.getElementById('articlesContainer');
            const filtered = filterArticles();
            const toShow = filtered.slice(0, displayCount);

            if (toShow.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="icon">üì°</div><p>Aucun article pour le moment.<br>Sois le premier a en proposer un !</p></div>';
                document.getElementById('loadMoreContainer').style.display = 'none';
                return;
            }

            container.innerHTML = toShow.map(article => {
                const badge = BADGE_MAP[article.category] || { cls: 'badge-ia', label: article.category };
                const date = article.timestamp ? formatDate(article.timestamp) : '';
                const tags = (article.tags || []).map(t => '<span class="tag">' + escapeHtml(t) + '</span>').join('');
                const liked = currentUser && article.likes && article.likes[currentUser.uid];

                return '<div class="article-card" data-category="' + escapeHtml(article.category || '') + '">' +
                    '<div class="article-header">' +
                        '<span class="article-badge ' + badge.cls + '">' + badge.label + '</span>' +
                        '<span class="article-date">' + date + '</span>' +
                    '</div>' +
                    '<h3 class="article-title">' + escapeHtml(article.title || '') + '</h3>' +
                    '<p class="article-summary">' + escapeHtml(article.summary || '') + '</p>' +
                    '<div class="article-footer">' +
                        '<div class="article-tags">' + tags + '</div>' +
                        '<div class="article-actions">' +
                            '<button class="action-btn' + (liked ? ' liked' : '') + '" onclick="toggleLike(\'' + article.id + '\')">' +
                                (liked ? '‚ù§Ô∏è' : 'ü§ç') + ' <span>' + (article.likesCount || 0) + '</span>' +
                            '</button>' +
                            (article.url ? '<a href="' + escapeHtml(article.url) + '" target="_blank" rel="noopener" class="action-btn">üîó Lire</a>' : '') +
                            '<button class="action-btn" onclick="shareArticle(\'' + article.id + '\')">üì§</button>' +
                            (isAdminUser ? '<button class="action-btn" style="border-color:var(--red);color:var(--red);" onclick="deleteArticle(\'' + article.id + '\')">üóëÔ∏è</button>' : '') +
                        '</div>' +
                    '</div>' +
                    (article.source ? '<div class="article-source" style="margin-top:10px;"><span class="source-dot"></span> ' + escapeHtml(article.source) + '</div>' : '') +
                '</div>';
            }).join('');

            document.getElementById('loadMoreContainer').style.display = filtered.length > displayCount ? 'flex' : 'none';
        }

        function formatDate(ts) {
            const d = new Date(ts);
            const now = new Date();
            const diff = now - d;
            if (diff < 60000) return 'A l\'instant';
            if (diff < 3600000) return Math.floor(diff / 60000) + ' min';
            if (diff < 86400000) return 'Il y a ' + Math.floor(diff / 3600000) + 'h';
            return d.toLocaleDateString('fr-FR', { day: 'numeric', month: 'short', year: 'numeric' });
        }

        function escapeHtml(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        // ==================== LIKE ====================
        function toggleLike(articleId) {
            if (!currentUser) {
                showToast('Connecte-toi pour liker !', 'warning');
                return;
            }

            // Mise a jour locale optimiste (UI reactive)
            const article = allArticles.find(a => a.id === articleId);
            if (!article) return;

            if (!article.likes) article.likes = {};
            const alreadyLiked = article.likes[currentUser.uid];

            if (alreadyLiked) {
                delete article.likes[currentUser.uid];
                article.likesCount = Math.max((article.likesCount || 1) - 1, 0);
            } else {
                article.likes[currentUser.uid] = true;
                article.likesCount = (article.likesCount || 0) + 1;
            }

            // Persister + re-render immediatement
            saveLikesToStorage();
            updateStats();
            renderArticles();

            // Synchroniser avec Firebase en arriere-plan
            const likePath = ARTICLES_PATH + '/' + articleId + '/likes/' + currentUser.uid;
            if (alreadyLiked) {
                db.ref(likePath).remove().catch(err => console.warn('Like sync error:', err.message));
                db.ref(ARTICLES_PATH + '/' + articleId + '/likesCount').transaction(v => Math.max((v || 1) - 1, 0));
            } else {
                db.ref(likePath).set(true).catch(err => console.warn('Like sync error:', err.message));
                db.ref(ARTICLES_PATH + '/' + articleId + '/likesCount').transaction(v => (v || 0) + 1);
            }
        }

        // ==================== SHARE ====================
        function shareArticle(articleId) {
            const article = allArticles.find(a => a.id === articleId);
            if (!article) return;
            const text = article.title + (article.url ? ' - ' + article.url : '');
            if (navigator.share) {
                navigator.share({ title: article.title, text: article.summary, url: article.url || window.location.href });
            } else {
                navigator.clipboard.writeText(text).then(() => showToast('Lien copie !'));
            }
        }

        // ==================== TRENDING ====================
        function renderTrending(items) {
            const list = document.getElementById('trendingList');
            if (items.length === 0) {
                list.innerHTML = '<p style="color:var(--text-secondary);font-size:0.9rem;">Pas encore de tendances. Like des articles !</p>';
                return;
            }
            list.innerHTML = items.map((item, i) => {
                return '<div class="trending-item">' +
                    '<span class="trending-rank">' + (i + 1) + '</span>' +
                    '<div>' +
                        '<div class="trending-text">' + escapeHtml(item.title || '') + '</div>' +
                        '<div class="trending-meta">‚ù§Ô∏è ' + (item.likesCount || 0) + ' likes</div>' +
                    '</div>' +
                '</div>';
            }).join('');
        }

        // Afficher les trending locaux immediatement
        const localTrending = SEED_ARTICLES.filter(a => a.likesCount > 0)
            .sort((a, b) => (b.likesCount || 0) - (a.likesCount || 0)).slice(0, 5);
        renderTrending(localTrending);

        function loadTrending() {
            db.ref(ARTICLES_PATH).orderByChild('likesCount').limitToLast(5).on('value', snap => {
                const items = [];
                snap.forEach(child => {
                    const val = child.val();
                    if (val.likesCount > 0) items.push(val);
                });
                items.reverse();
                renderTrending(items.length > 0 ? items : localTrending);
            }, err => {
                console.warn('Firebase trending indisponible:', err.message);
            });
        }

        // ==================== DELETE (Admin) ====================
        function deleteArticle(articleId) {
            if (!isAdminUser) return;
            if (!confirm('Supprimer cet article ?')) return;
            db.ref(ARTICLES_PATH + '/' + articleId).remove()
                .then(() => showToast('Article supprime'))
                .catch(err => showToast('Erreur : ' + err.message, 'error'));
        }

        // ==================== SUBMIT (Admin) ====================
        document.getElementById('submitForm').addEventListener('submit', async e => {
            e.preventDefault();
            if (!isAdminUser) {
                showToast('Acces reserve a l\'administrateur', 'error');
                return;
            }

            const title = document.getElementById('submitTitle').value.trim();
            const url = document.getElementById('submitUrl').value.trim();
            const summary = document.getElementById('submitSummary').value.trim();
            const category = document.getElementById('submitCategory').value;

            if (!title || !url || !summary || !category) {
                showToast('Remplis tous les champs', 'error');
                return;
            }

            let source = '';
            try { source = new URL(url).hostname.replace('www.', ''); } catch(e) { source = url; }

            const submitBtn = document.querySelector('.submit-btn');
            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ Envoi...';

            const newArticle = {
                title: title,
                url: url,
                summary: summary,
                category: category,
                tags: extractTags(title + ' ' + summary),
                source: source,
                timestamp: Date.now(),
                authorUid: currentUser.uid,
                authorName: currentUser.displayName || 'Admin',
                likesCount: 0
            };

            let savedToFirebase = false;
            try {
                const ref = await db.ref(ARTICLES_PATH).push(newArticle);
                newArticle.id = ref.key;
                savedToFirebase = true;
            } catch (err) {
                console.warn('Firebase write echoue, sauvegarde locale:', err.code);
            }

            // Fallback local si Firebase echoue
            if (!savedToFirebase) {
                newArticle.id = 'local_' + Date.now();
                // Sauvegarder dans localStorage
                const localArticles = JSON.parse(localStorage.getItem('localVeilleArticles') || '[]');
                localArticles.push(newArticle);
                localStorage.setItem('localVeilleArticles', JSON.stringify(localArticles));
            }

            // Ajouter a la liste affichee
            allArticles.unshift(newArticle);
            updateStats();
            renderArticles();
            document.getElementById('submitForm').reset();
            showToast(savedToFirebase ? 'Article publie dans Firebase !' : 'Article sauvegarde localement (Firebase indisponible)');
            submitBtn.disabled = false;
            submitBtn.textContent = 'üöÄ Soumettre';
        });

        function extractTags(text) {
            const keywords = ['IA', 'GPT', 'ChatGPT', 'Claude', 'Gemini', 'OpenAI', 'Anthropic', 'Google', 'Meta', 'LLM',
                'robot', 'machine learning', 'deep learning', 'startup', 'ethique', 'regulation', 'open source',
                'GPU', 'NVIDIA', 'Apple', 'Microsoft', 'AGI', 'API', 'modele', 'image', 'video', 'voix'];
            const lower = text.toLowerCase();
            return keywords.filter(k => lower.includes(k.toLowerCase())).slice(0, 5);
        }

        // ==================== SEARCH & FILTER ====================
        document.getElementById('searchInput').addEventListener('input', e => {
            searchQuery = e.target.value;
            displayCount = 10;
            renderArticles();
        });

        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentCategory = btn.dataset.category;
                displayCount = 10;
                renderArticles();
            });
        });

        document.getElementById('loadMoreBtn').addEventListener('click', () => {
            displayCount += 10;
            renderArticles();
        });

        // ==================== TOAST ====================
        function showToast(msg, type) {
            const existing = document.querySelector('.toast');
            if (existing) existing.remove();
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = msg;
            if (type === 'error') toast.style.background = 'linear-gradient(135deg, #ff4444, #ff0066)';
            else if (type === 'warning') toast.style.background = 'linear-gradient(135deg, #ff9500, #ffcc00)';
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // ==================== SEED ARTICLES (Admin, une seule fois) ====================
        async function seedArticles() {
            console.log('[SEED] seedArticles() appelee, articlesSeeded =', articlesSeeded);
            if (articlesSeeded) { console.log('[SEED] Deja seede, on arrete'); return; }
            try {
                console.log('[SEED] Lecture de', ARTICLES_PATH, '...');
                const snap = await db.ref(ARTICLES_PATH).once('value');
                console.log('[SEED] snap.exists() =', snap.exists(), ', nb enfants =', snap.numChildren());
                if (snap.exists()) { articlesSeeded = true; console.log('[SEED] Articles existent deja'); return; }

                const updates = {};
                SEED_ARTICLES.forEach(article => {
                    const { id, ...data } = article;
                    updates[id] = data;
                });
                console.log('[SEED] Ecriture de', Object.keys(updates).length, 'articles dans', ARTICLES_PATH, '...');

                await db.ref(ARTICLES_PATH).update(updates);
                articlesSeeded = true;
                console.log('[SEED] Succes !');
                showToast('15 articles charges dans Firebase !');
            } catch (err) {
                console.warn('[SEED] Firebase write echoue (rules non deployees ?):', err.code);
            }
        }

        // ==================== INIT ====================
        loadArticles();
        loadTrending();

        // Quand l'admin se connecte, tenter de synchroniser les articles dans Firebase
        auth.onAuthStateChanged(user => {
            if (isAdmin(user)) seedArticles();
        });
    </script>
</body>
</html>
